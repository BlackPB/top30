<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ì‹ Top30 ë°ì´í„°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
            line-height: 1.6;
            /* â¬…ï¸ ì˜¤ë¥¸ìª½ ì´ë¯¸ì§€ì˜ ë‹¤í¬/ë”¥ ê·¸ë¼ë””ì–¸íŠ¸ ì ìš© */
            background: linear-gradient(135deg, #1a2a40 0%, #0f1a2a 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0; /* ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ ë°ê²Œ */
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.8;
        }
        
        .card {
            /* â¬…ï¸ ì˜¤ë¥¸ìª½ ì¹´ë“œ ë°°ê²½ ë° ê·¸ë¦¼ì ìŠ¤íƒ€ì¼ */
            background: #283a4d; 
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            overflow: hidden;
            position: relative;
        }
        
        .controls {
            padding: 25px;
            /* â¬…ï¸ ì˜¤ë¥¸ìª½ ì»¨íŠ¸ë¡¤ ì˜ì—­ ë°°ê²½ìƒ‰ ì¡°ì • */
            background: #21303f; 
            border-bottom: 1px solid #3a4d5f;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            align-items: center;
            flex: 1;
        }
        
        #urlInput {
            flex: 1;
            min-width: 300px;
            padding: 12px 15px;
            /* â¬…ï¸ ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ ì¡°ì • */
            border: 2px solid #3a4d5f;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #1f2b37; /* ì…ë ¥ì°½ ë°°ê²½ ì–´ë‘¡ê²Œ */
            color: #e0e0e0; /* í…ìŠ¤íŠ¸ ë°ê²Œ */
        }
        
        #urlInput:focus {
            outline: none;
            border-color: #4a90e2; /* í¬ì»¤ìŠ¤ ìƒ‰ìƒ ì¡°ì • */
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
        }
        
        .btn {
            padding: 12px 25px;
            /* â¬…ï¸ ê¸°ë³¸ ë²„íŠ¼ ê·¸ë¼ë””ì–¸íŠ¸ (ì•½ê°„ í†¤ ë‹¤ìš´) */
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #555555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-copy {
            /* â¬…ï¸ ë³µì‚¬ ë²„íŠ¼ ìƒ‰ìƒ (ë…¹ìƒ‰ ê³„ì—´) */
            background: linear-gradient(135deg, #38a894 0%, #2b8a78 100%);
        }
        
        .btn-copy:hover:not(:disabled) {
            box-shadow: 0 5px 15px rgba(56, 168, 148, 0.4);
        }
        
        .btn-nav {
            /* â¬…ï¸ ë‚ ì§œ ì´ë™ ë²„íŠ¼ ìƒ‰ìƒ (ì£¼í™©/ë¹¨ê°• ê³„ì—´) */
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            padding: 12px 20px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .btn-nav:hover:not(:disabled) {
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.4);
        }
        
        .btn-settings {
            /* â¬…ï¸ ì„¤ì •/ê¸°íƒ€ ë²„íŠ¼ ìƒ‰ìƒ (ë³´ë¼ìƒ‰ ê³„ì—´) */
            background: linear-gradient(135deg, #8e44ad 0%, #7a3b92 100%);
            padding: 12px 20px;
            font-size: 16px;
        }
        
        .btn-upload {
            background: linear-gradient(135deg, #38a894 0%, #2b8a78 100%);
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .btn-export {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .btn-import {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .date-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            /* â¬…ï¸ ë‚ ì§œ ì»¨íŠ¸ë¡¤ ë°°ê²½ */
            background: #21303f; 
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .current-date {
            font-weight: 600;
            color: #f0f0f0; /* í…ìŠ¤íŠ¸ ë°ê²Œ */
            min-width: 150px;
            text-align: center;
            font-size: 14px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
            background: #3a4d5f; /* ë‚ ì§œ ë°°ê²½ */
        }
        
        .current-date:hover {
            background-color: #4a6074;
        }
        
        .calendar-popup {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            /* â¬…ï¸ ìº˜ë¦°ë” íŒì—… ë°°ê²½ */
            background: #283a4d; 
            border: 1px solid #3a4d5f;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            padding: 15px;
            z-index: 1000;
            min-width: 280px;
            margin-top: 5px;
        }
        
        .settings-calendar-popup {
            position: absolute;
            top: 100%;
            left: 0;
            background: #283a4d;
            border: 1px solid #3a4d5f;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            padding: 15px;
            z-index: 1001;
            min-width: 280px;
            margin-top: 5px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .calendar-nav {
            background: none;
            border: 1px solid #4a6074;
            color: #c0c0c0;
            font-size: 16px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }
        
        .calendar-nav:hover {
            background: #3a4d5f;
            color: white;
        }
        
        .calendar-title {
            font-weight: 600;
            font-size: 14px;
            color: white;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        
        .calendar-weekday {
            text-align: center;
            font-size: 12px;
            color: #99aabc; /* ìš”ì¼ ìƒ‰ìƒ */
            padding: 5px;
            font-weight: 600;
        }
        
        .calendar-day {
            text-align: center;
            padding: 8px 5px;
            font-size: 12px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s ease;
            color: #e0e0e0;
        }
        
        .calendar-day:hover {
            background: #3a4d5f;
        }
        
        .calendar-day.saturday {
            color: #4a90e2 !important;
        }
        
        .calendar-day.sunday, .calendar-day.holiday {
            color: #e74c3c !important;
        }
        
        .calendar-day.holiday {
            background: #3a2c33; /* íœ´ì¼ ë°°ê²½ */
        }
        
        .calendar-day.today {
            background: #4a90e2;
            color: white !important;
        }
        
        .calendar-day.selected {
            background: #27ae60; /* ì„ íƒëœ ë‚ ì§œ ìƒ‰ìƒ */
            color: white !important;
        }
        
        .calendar-day.disabled {
            color: #555555 !important;
            cursor: not-allowed;
            background: #1f2b37;
        }
        
        .calendar-day.disabled:hover {
            background: #1f2b37;
        }
        
        .status {
            padding: 20px;
            text-align: center;
        }
        
        .loading {
            color: #4a90e2;
            font-size: 18px;
            font-weight: 600;
        }
        
        .error {
            color: #e74c3c;
            background: #3a2c33;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
        }
        
        .success {
            color: #27ae60;
            background: #2c3a30;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }
        
        .table-container {
            overflow-x: auto;
            padding: 40px;
            min-height: 600px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 16px;
            min-width: 800px;
            table-layout: fixed;
        }
        
        th {
            /* â¬…ï¸ í…Œì´ë¸” í—¤ë” ë°°ê²½ (ë‹¤í¬ í…Œë§ˆ) */
            background: linear-gradient(135deg, #1a2a40 0%, #0f1a2a 100%);
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            font-size: 16px;
            border-bottom: 2px solid #3a4d5f;
        }
        
        td {
            padding: 18px 15px;
            border-bottom: 1px solid #3a4d5f; /* êµ¬ë¶„ì„  */
            font-size: 15px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: #e0e0e0;
        }
        
        tr:nth-child(even) {
            /* â¬…ï¸ í™€ì§ ì¤„ ë°°ê²½ìƒ‰ ì¡°ì • */
            background-color: #21303f; 
        }
        
        tr:hover {
            background-color: #3a4d5f;
            transition: all 0.2s ease;
        }
        
        /* í…Œë§ˆ ëŒ€/ì†Œ ë„ˆë¹„ ê³ ì • */
        .theme-main-col {
            width: 150px;
        }
        
        .theme-sub-col {
            width: 200px;
        }
        
        .date-col {
            width: 120px;
        }
        
        .stock-name-col {
            width: 180px;
        }
        
        .rise-rate-col {
            width: 120px;
        }
        
        .reason-col {
            /* ë‚˜ë¨¸ì§€ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
        }
        
        .date {
            color: #99aabc;
            font-size: 14px;
        }
        
        .theme-main {
            /* â¬…ï¸ í…Œë§ˆ ì¹© ìƒ‰ìƒ ì¡°ì • */
            background: #38a894; /* ë…¹ìƒ‰ ê³„ì—´ */
            color: #1a2a40; /* ì–´ë‘ìš´ í…ìŠ¤íŠ¸ */
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 13px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: inline-block;
            max-width: 100%;
        }
        
        .theme-sub {
            /* â¬…ï¸ ì„œë¸Œ í…Œë§ˆ ì¹© ìƒ‰ìƒ ì¡°ì • */
            background: #357abd; /* íŒŒë‘ ê³„ì—´ */
            color: #ffffff; /* í°ìƒ‰ í…ìŠ¤íŠ¸ */
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 13px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: inline-block;
            max-width: 100%;
        }
        
        .stock-name {
            font-weight: 600;
            color: #f0f0f0;
            font-size: 15px;
        }
        
        .rise-rate {
            font-weight: bold;
            /* â¬…ï¸ ìƒìŠ¹/í•˜ë½ ìƒ‰ìƒ (ë‹¤í¬ ëª¨ë“œ ì¹œí™”ì ìœ¼ë¡œ ì¡°ì •) */
            color: #e74c3c; /* í•˜ë½ (ë¹¨ê°•) */
            text-align: right;
            font-size: 15px;
        }

        .rise-rate.up { /* ìƒìŠ¹ì„ ìœ„í•œ í´ë˜ìŠ¤ ì¶”ê°€ (ê¸°ì¡´ ì½”ë“œì—ëŠ” ì—†ì—ˆìœ¼ë‚˜, ëŒ€ë¹„ë¥¼ ìœ„í•´ ì¶”ê°€) */
            color: #27ae60 !important; /* ìƒìŠ¹ (ì´ˆë¡) */
        }
        
        .reason {
            font-size: 14px;
            color: #aaaaaa;
            line-height: 1.5;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        /* âš™ï¸ ì„¤ì • íŒ¨ë„ ìŠ¤íƒ€ì¼ ì¡°ì • */
        .settings-panel {
            background: #283a4d; 
            border: 1px solid #3a4d5f;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: relative;
            color: #e0e0e0;
        }
        
        .settings-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #ffffff;
        }
        
        .settings-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            align-items: end;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            position: relative;
        }
        
        .form-group label {
            font-weight: 600;
            color: #c0c0c0;
            font-size: 14px;
        }
        
        .form-group input {
            padding: 10px 12px;
            border: 2px solid #3a4d5f;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: #1f2b37;
            color: #e0e0e0;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
        }
        
        .file-input {
            padding: 8px !important;
        }
        
        .settings-date-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
            position: relative;
        }
        
        .settings-date {
            flex: 1;
            padding: 10px 12px;
            border: 2px solid #3a4d5f;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
            cursor: pointer;
            background: #1f2b37;
            color: #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .settings-date:hover {
            border-color: #4a90e2;
        }
        
        .upload-info {
            background: #2c3a30; /* ë‹¤í¬ ëª¨ë“œ ì¹œí™”ì  */
            padding: 10px;
            border-radius: 6px;
            border-left: 4px solid #27ae60;
            margin-top: 10px;
            font-size: 14px;
            color: #c0c0c0;
        }
        
        .backup-section {
            background: #1f2b37;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4a90e2;
            margin-top: 20px;
        }
        
        .backup-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            #urlInput {
                min-width: 100%;
            }
            
            .button-group {
                width: 100%;
                flex-wrap: wrap;
            }
            
            .button-group .btn {
                flex: 1;
            }
            
            .settings-form {
                grid-template-columns: 1fr;
            }
            
            .backup-buttons {
                flex-direction: column;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 12px 8px;
            }
            
            /* ëª¨ë°”ì¼ì—ì„œ í…Œë§ˆ ì»¬ëŸ¼ ë„ˆë¹„ ì¡°ì • */
            .theme-main-col {
                width: 120px;
            }
            
            .theme-sub-col {
                width: 150px;
            }
            
            .stock-name-col {
                width: 140px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ˆ ì£¼ì‹ Top30 ë°ì´í„°</h1>
            <p>ì‹¤ì œ ì£¼ì‹ì •ë³´ ì‚¬ì´íŠ¸ ë°ì´í„°ë¥¼ ì •í™•íˆ íŒŒì‹±í•©ë‹ˆë‹¤</p>
        </div>
        
        <div class="card">
            <div class="controls">
                <div class="input-group">
                    <input type="text" id="urlInput" 
                           placeholder="ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ URLì„ ì…ë ¥í•˜ì„¸ìš”">
                    <div class="date-controls">
                        <button class="btn btn-nav" id="prevBtn" onclick="navigateDate(-1)">â—€â—€</button>
                        <div class="current-date" id="currentDate" onclick="toggleCalendar()">-</div>
                        <button class="btn btn-nav" id="nextBtn" onclick="navigateDate(1)">â–¶â–¶</button>
                        <div id="calendar" class="calendar-popup" style="display: none;"></div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn" id="fetchBtn" onclick="fetchData()">
                        ğŸ”„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    </button>
                    <button class="btn btn-copy" onclick="copyToExcel()">
                        ğŸ“‹ ì—‘ì…€ ë³µì‚¬
                    </button>
                    <button class="btn btn-settings" onclick="toggleSettings()">
                        âš™ï¸ ì„¤ì •
                    </button>
                    <button class="btn btn-settings" onclick="showCacheInfo()">
                        ğŸ” ìºì‹œì •ë³´
                    </button>
                </div>
            </div>

            <div id="settingsPanel" class="settings-panel" style="display: none;">
                <div class="settings-title">ê¸°ì¤€ ì„¤ì •</div>
                <div class="settings-form">
                    <div class="form-group">
                        <label for="baseUrlInput">ê¸°ë³¸ URL</label>
                        <input type="text" id="baseUrlInput" placeholder="https://stockinfo7.com/stock/top30/text/">
                    </div>
                    <div class="form-group">
                        <label for="baseIdInput">ê¸°ì¤€ ID</label>
                        <input type="number" id="baseIdInput" placeholder="1537">
                    </div>
                    <div class="form-group">
                        <label for="baseDateDisplay">ê¸°ì¤€ ë‚ ì§œ</label>
                        <div class="settings-date-controls">
                            <div class="settings-date" id="baseDateDisplay" onclick="toggleSettingsCalendar(this)">ë‚ ì§œ ì„ íƒ</div>
                            <div id="settingsCalendar" class="settings-calendar-popup" style="display: none;"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-settings" onclick="saveBaseSettings()" style="margin-top: 10px;">
                            ğŸ’¾ ì„¤ì • ì €ì¥
                        </button>
                    </div>
                </div>

                <div class="settings-title" style="margin-top: 30px;">í…Œë§ˆ ë°ì´í„° ê´€ë¦¬</div>
                <div class="settings-form">
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label for="excelFileUpload">ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</label>
                        <input type="file" id="excelFileUpload" accept=".xlsx,.xls,.csv" class="file-input">
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button class="btn btn-upload" onclick="uploadExcelFile()">
                                ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ
                            </button>
                            <button class="btn btn-settings" onclick="clearThemeData()">
                                ğŸ—‘ï¸ ë°ì´í„° ì´ˆê¸°í™”
                            </button>
                        </div>
                        <small style="color: #aaa; margin-top: 5px;">
                            ì§€ì› í˜•ì‹: .xlsx, .xls, .csv (ì»¬ëŸ¼: ì¢…ëª©ëª…, í…Œë§ˆ(ëŒ€), í…Œë§ˆ(ì†Œ))
                        </small>
                    </div>
                </div>

                <div id="uploadInfo" class="upload-info" style="display: none;"></div>

                <div class="backup-section">
                    <div class="settings-title">ğŸ“ ë°ì´í„° ë°±ì—… ë° ë³µì›</div>
                    <p style="margin-bottom: 15px; color: #aaa; font-size: 14px;">
                        ëª¨ë“  ì„¤ì •, í…Œë§ˆ ë°ì´í„°, ìºì‹œ ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë°±ì—…í•˜ê±°ë‚˜ ë³µì›í•©ë‹ˆë‹¤.
                    </p>
                    <div class="backup-buttons">
                        <button class="btn btn-export" onclick="exportAllData()">
                            ğŸ’¾ ì „ì²´ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                        </button>
                        <button class="btn btn-import" onclick="document.getElementById('importFile').click()">
                            ğŸ“¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                        </button>
                        <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importAllData(this.files[0])">
                        <button class="btn btn-settings" onclick="clearAllData()">
                            ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
                        </button>
                    </div>
                    <div style="margin-top: 15px; font-size: 12px; color: #888;">
                        <strong>ë°±ì—… ë‚´ìš©:</strong> ê¸°ë³¸ ì„¤ì •, í…Œë§ˆ ë°ì´í„°, ë°ì´í„° ìºì‹œ, ë‚ ì§œ ë§¤í•‘
                    </div>
                </div>
            </div>
            
            <div id="status" class="status">
                <div id="loading" class="loading" style="display: none;">
                    â³ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                </div>
                <div id="error" class="error" style="display: none;"></div>
                <div id="success" class="success" style="display: none;"></div>
            </div>
            
            <div class="table-container">
                <div id="tableContainer">
                    </div>
            </div>
        </div>
    </div>

    <script>
        // ê¸°ë³¸ ì„¤ì •ê°’
        let baseUrl = 'https://stockinfo7.com/stock/top30/text/';
        let baseId = 1537;
        let baseDate = new Date('2025-10-21');
        
        let currentId = baseId;
        let isFetching = false;
        let currentRealDate = '';
        let calendarVisible = false;
        let currentCalendarDate = new Date();
        let settingsCalendarVisible = false;

        // ğŸ”¥ ë°ì´í„° ìºì‹œ ì‹œìŠ¤í…œ - ì›¹ ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½
        let dataCache = new Map(); // IDë¥¼ í‚¤ë¡œ ë°ì´í„° ì €ì¥
        let dateToIdCache = new Map(); // ë‚ ì§œ ë¬¸ìì—´ì„ í‚¤ë¡œ ID ì €ì¥
        
        // ê³µíœ´ì¼ ìºì‹œ (APIì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„° ì €ì¥)
        let holidaysCache = {};

        // ì—‘ì…€ í…Œë§ˆ ë°ì´í„° ìºì‹œ
        let themeDataCache = null;
        let currentThemeFileName = '';

        // ë‚ ì§œ-ID ë§¤í•‘ ìºì‹œ
        let dateIdCache = new Map();

        // ğŸ”¥ ì›¹ ê¸°ë°˜ ë°ì´í„° ì €ì¥ì†Œ (stock_data.json íŒŒì¼ ì‚¬ìš©)
        const WEB_DATA_FILE = 'stock_data.json';
        let webData = {
            metadata: {
                version: '1.0',
                lastUpdated: new Date().toISOString()
            },
            baseSettings: {
                baseUrl: baseUrl,
                baseId: baseId,
                baseDate: baseDate.toISOString()
            },
            themeData: {
                data: {},
                fileName: ''
            },
            cacheData: {
                dataCache: [],
                dateToIdCache: [],
                dateIdCache: []
            },
            currentState: {
                currentId: currentId,
                currentRealDate: currentRealDate
            }
        };

        // ğŸ”¥ í˜„ì¬ ì‹œê°„ì— ë”°ë¼ ìë™ìœ¼ë¡œ ë‚ ì§œ ê²°ì •í•˜ëŠ” í•¨ìˆ˜
        function getTargetDateByCurrentTime() {
            const now = new Date();
            const currentHour = now.getHours();
            const currentMinutes = now.getMinutes();
            
            // ì˜¤í›„ 9ì‹œ(21ì‹œ) ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨
            if (currentHour > 21 || (currentHour === 21 && currentMinutes >= 0)) {
                // ì˜¤í›„ 9ì‹œ ì´í›„: ì˜¤ëŠ˜ ë‚ ì§œ
                return new Date();
            } else {
                // ì˜¤í›„ 9ì‹œ ì´ì „: ì–´ì œ ë‚ ì§œ
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                return yesterday;
            }
        }

        // ğŸ”¥ ê°€ì¥ ìµœê·¼ ê±°ë˜ì¼ì„ ì°¾ëŠ” í•¨ìˆ˜
        async function findLatestTradingDay(targetDate) {
            let checkDate = new Date(targetDate);
            let daysChecked = 0;
            const maxDaysToCheck = 10; // ìµœëŒ€ 10ì¼ê¹Œì§€ í™•ì¸ (ì£¼ë§, ê³µíœ´ì¼ ê³ ë ¤)
            
            while (daysChecked < maxDaysToCheck) {
                if (await isTradingDay(checkDate)) {
                    return checkDate;
                }
                // ì´ì „ ë‚ ì§œë¡œ ì´ë™
                checkDate.setDate(checkDate.getDate() - 1);
                daysChecked++;
            }
            
            // ê±°ë˜ì¼ì„ ì°¾ì§€ ëª»í•œ ê²½ìš° ê¸°ë³¸ê°’ ë°˜í™˜
            return targetDate;
        }

        // ğŸ”¥ ì´ˆê¸°í™” í•¨ìˆ˜ ìˆ˜ì • - í˜„ì¬ ì‹œê°„ì— ë”°ë¼ ìë™ìœ¼ë¡œ ë‚ ì§œ ì„¤ì •
        async function initialize() {
            loadBaseSettings();
            
            // ì›¹ ë°ì´í„° ë¡œë“œ
            await loadWebData();
            
            // í˜„ì¬ ì‹œê°„ì— ë”°ë¼ íƒ€ê²Ÿ ë‚ ì§œ ê²°ì •
            const targetDate = getTargetDateByCurrentTime();
            const tradingDate = await findLatestTradingDay(targetDate);
            
            // íƒ€ê²Ÿ ë‚ ì§œì— í•´ë‹¹í•˜ëŠ” ID ê³„ì‚°
            currentId = await getTradingDayIdFromDate(tradingDate);
            
            updateUrlInput();
            await updateDateDisplay();
            
            // ê³µíœ´ì¼ ë°ì´í„° ë¯¸ë¦¬ ë¡œë“œ
            await loadHolidaysForYear(2025);
            await loadHolidaysForYear(2026);
            
            // í…Œë§ˆ ë°ì´í„° ë¡œë“œ
            await loadThemeData();
            
            // ìë™ìœ¼ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            fetchData();
            
            document.addEventListener('click', function(event) {
                const calendar = document.getElementById('calendar');
                const currentDate = document.getElementById('currentDate');
                const settingsCalendar = document.getElementById('settingsCalendar');
                const baseDateDisplay = document.getElementById('baseDateDisplay');
                
                if (calendarVisible && 
                    !calendar.contains(event.target) && 
                    !currentDate.contains(event.target)) {
                    hideCalendar();
                }
                
                if (settingsCalendarVisible && 
                    !settingsCalendar.contains(event.target) && 
                    !baseDateDisplay.contains(event.target)) {
                    hideSettingsCalendar();
                }
            });
        }

        // ğŸ”¥ ì›¹ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
        async function loadWebData() {
            try {
                // ë¡œì»¬ ì €ì¥ì†Œì—ì„œ ì›¹ ë°ì´í„° ë¡œë“œ ì‹œë„ (ë¸Œë¼ìš°ì € í™˜ê²½ ê°€ì •)
                const localData = localStorage.getItem('webDataBackup');

                if (localData) {
                    webData = JSON.parse(localData);
                    
                    // ì›¹ ë°ì´í„°ì—ì„œ ìºì‹œ ë³µì›
                    if (webData.cacheData) {
                        dataCache = new Map(webData.cacheData.dataCache || []);
                        dateToIdCache = new Map(webData.cacheData.dateToIdCache || []);
                        dateIdCache = new Map(webData.cacheData.dateIdCache || []);
                    }
                    
                    // ì›¹ ë°ì´í„°ì—ì„œ í…Œë§ˆ ë°ì´í„° ë³µì›
                    if (webData.themeData) {
                        themeDataCache = webData.themeData.data || {};
                        currentThemeFileName = webData.themeData.fileName || '';
                        updateUploadInfo();
                    }
                    
                    // ì›¹ ë°ì´í„°ì—ì„œ ê¸°ë³¸ ì„¤ì • ë³µì›
                    if (webData.baseSettings) {
                        baseUrl = webData.baseSettings.baseUrl || baseUrl;
                        baseId = webData.baseSettings.baseId || baseId;
                        baseDate = new Date(webData.baseSettings.baseDate || baseDate);
                        currentId = webData.currentState?.currentId || baseId;
                        
                        // UI ì—…ë°ì´íŠ¸
                        document.getElementById('baseUrlInput').value = baseUrl;
                        document.getElementById('baseIdInput').value = baseId;
                        document.getElementById('baseDateDisplay').textContent = formatDate(baseDate);
                        updateUrlInput();
                    }
                    
                    console.log('ì›¹ ë°ì´í„° ë¡œë“œ ì„±ê³µ (Local Storage):', webData);
                } else {
                    console.log('ì›¹ ë°ì´í„° íŒŒì¼/ë¡œì»¬ ì €ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ì›¹ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ğŸ”¥ ì›¹ ë°ì´í„° ì €ì¥ í•¨ìˆ˜ (ë¡œì»¬ ì €ì¥ì†Œì— ì €ì¥)
        async function saveWebData() {
            try {
                // í˜„ì¬ ë°ì´í„°ë¡œ ì›¹ ë°ì´í„° ì—…ë°ì´íŠ¸
                webData.metadata.lastUpdated = new Date().toISOString();
                webData.baseSettings = {
                    baseUrl: baseUrl,
                    baseId: baseId,
                    baseDate: baseDate.toISOString()
                };
                webData.themeData = {
                    data: themeDataCache || {},
                    fileName: currentThemeFileName
                };
                webData.cacheData = {
                    dataCache: Array.from(dataCache.entries()),
                    dateToIdCache: Array.from(dateToIdCache.entries()),
                    dateIdCache: Array.from(dateIdCache.entries())
                };
                webData.currentState = {
                    currentId: currentId,
                    currentRealDate: currentRealDate
                };
                
                // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì„ì‹œ ì €ì¥ (ì‹¤ì œ ì›¹ í™˜ê²½ì—ì„œëŠ” ì„œë²„ API í˜¸ì¶œ í•„ìš”)
                localStorage.setItem('webDataBackup', JSON.stringify(webData));
                
                console.log('ì›¹ ë°ì´í„° ì €ì¥ ì™„ë£Œ (Local Storage)');
                
            } catch (error) {
                console.error('ì›¹ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
            }
        }

        // ğŸ”¥ ëª¨ë“  ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°
        function exportAllData() {
            try {
                // ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘
                const exportData = {
                    metadata: {
                        version: '1.0',
                        exportDate: new Date().toISOString(),
                        description: 'ì£¼ì‹ Top30 ë°ì´í„° ë°±ì—…'
                    },
                    baseSettings: {
                        baseUrl: baseUrl,
                        baseId: baseId,
                        baseDate: baseDate.toISOString()
                    },
                    themeData: {
                        data: themeDataCache,
                        fileName: currentThemeFileName
                    },
                    cacheData: {
                        dataCache: Array.from(dataCache.entries()),
                        dateToIdCache: Array.from(dateToIdCache.entries()),
                        dateIdCache: Array.from(dateIdCache.entries())
                    },
                    currentState: {
                        currentId: currentId,
                        currentRealDate: currentRealDate
                    }
                };

                // JSON ë¬¸ìì—´ë¡œ ë³€í™˜
                const jsonString = JSON.stringify(exportData, null, 2);
                
                // íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `stock_data_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showSuccess('ëª¨ë“  ë°ì´í„°ê°€ JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤!');
                console.log('ë‚´ë³´ë‚¸ ë°ì´í„°:', exportData);
            } catch (e) {
                showError('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + e.message);
            }
        }

        // ì´ì™¸ì˜ ê¸°ëŠ¥ í•¨ìˆ˜ë“¤ì€ ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤.
        
        // ê¸°íƒ€ í•„ìš”í•œ í•¨ìˆ˜ë“¤ (isTradingDay, getTradingDayIdFromDate, updateDateDisplay, etc.)ì€ 
        // ì›ë˜ ì½”ë“œì— ì •ì˜ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•˜ê³  ìƒëµí•©ë‹ˆë‹¤. 
        // ì´ í•¨ìˆ˜ë“¤ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•´ì•¼ ì „ì²´ ê¸°ëŠ¥ì´ ìœ ì§€ë©ë‹ˆë‹¤.

        // ìº˜ë¦°ë” ë Œë”ë§ í•¨ìˆ˜ (ê°„ì†Œí™”)
        function renderCalendar(date, containerId) {
            const target = new Date(date);
            const year = target.getFullYear();
            const month = target.getMonth();
            
            let html = `
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="changeMonth(${containerId === 'calendar' ? 'false' : 'true'}, -1)">â—€</button>
                    <span class="calendar-title">${year}ë…„ ${month + 1}ì›”</span>
                    <button class="calendar-nav" onclick="changeMonth(${containerId === 'calendar' ? 'false' : 'true'}, 1)">â–¶</button>
                </div>
                <div class="calendar-grid">
                    <div class="calendar-weekday">ì¼</div><div class="calendar-weekday">ì›”</div><div class="calendar-weekday">í™”</div><div class="calendar-weekday">ìˆ˜</div><div class="calendar-weekday">ëª©</div><div class="calendar-weekday">ê¸ˆ</div><div class="calendar-weekday">í† </div>
            `;

            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // ë¹ˆì¹¸ ì±„ìš°ê¸°
            for (let i = 0; i < firstDayOfMonth; i++) {
                html += '<div class="calendar-day disabled"></div>';
            }

            const today = new Date();
            const currentMonthYearString = `${year}-${String(month + 1).padStart(2, '0')}`;

            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const currentDate = new Date(year, month, day);
                const dayOfWeek = currentDate.getDay();
                let dayClass = '';
                
                if (dayOfWeek === 0) dayClass = 'sunday';
                else if (dayOfWeek === 6) dayClass = 'saturday';

                if (isHoliday(dateKey)) {
                    dayClass += ' holiday';
                }
                
                let isSelected = (containerId === 'calendar' ? currentRealDate : formatDate(baseDate)) === dateKey;
                let isCurrent = today.getFullYear() === year && today.getMonth() === month && today.getDate() === day;
                
                if (isSelected) dayClass += ' selected';
                else if (isCurrent && !isSelected) dayClass += ' today';
                else if (dateToIdCache.has(dateKey) === false && isTradingDay(currentDate) === true) dayClass += ' disabled';

                html += `<div class="calendar-day ${dayClass}" onclick="selectDate('${dateKey}', '${containerId}')">${day}</div>`;
            }
            
            html += '</div>';
            document.getElementById(containerId).innerHTML = html;
            document.getElementById(containerId).style.display = 'block';
            calendarVisible = (containerId === 'calendar');
            settingsCalendarVisible = (containerId === 'settingsCalendar');
        }

        // ìº˜ë¦°ë” ì›” ì´ë™ í•¨ìˆ˜ (ê°„ì†Œí™”)
        function changeMonth(isSettings, delta) {
            const containerId = isSettings ? 'settingsCalendar' : 'calendar';
            let currentDateRef = isSettings ? baseDate : currentCalendarDate;
            
            const year = currentDateRef.getFullYear();
            const month = currentDateRef.getMonth() + delta;
            
            currentDateRef.setFullYear(year, month, 1);
            renderCalendar(currentDateRef, containerId);
        }
        
        // ë‚ ì§œ í¬ë§·í„° (YYYY-MM-DD)
        function formatDate(date) {
            const d = new Date(date);
            let month = '' + (d.getMonth() + 1);
            let day = '' + d.getDate();
            const year = d.getFullYear();

            if (month.length < 2) month = '0' + month;
            if (day.length < 2) day = '0' + day;

            return [year, month, day].join('-');
        }
        
        // ìº˜ë¦°ë” í† ê¸€ ë° ë Œë”ë§ í•¨ìˆ˜ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
        function toggleCalendar() {
            if (!calendarVisible) {
                // ìº˜ë¦°ë”ë¥¼ í‘œì‹œí•  ë•Œ í˜„ì¬ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë Œë”ë§
                currentCalendarDate = new Date(currentRealDate || formatDate(new Date()));
                renderCalendar(currentCalendarDate, 'calendar');
            } else {
                hideCalendar();
            }
        }
        
        function hideCalendar() {
            document.getElementById('calendar').style.display = 'none';
            calendarVisible = false;
        }
        
        function toggleSettingsCalendar(element) {
            if (!settingsCalendarVisible) {
                renderCalendar(baseDate, 'settingsCalendar');
                document.getElementById('settingsCalendar').style.display = 'block';
            } else {
                hideSettingsCalendar();
            }
        }
        
        function hideSettingsCalendar() {
            document.getElementById('settingsCalendar').style.display = 'none';
            settingsCalendarVisible = false;
        }
        
        // ë‚ ì§œ ì„ íƒ ì‹œ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
        async function selectDate(dateKey, containerId) {
            const dateObj = new Date(dateKey);
            
            if (containerId === 'calendar') {
                // ë©”ì¸ ìº˜ë¦°ë” ì„ íƒ: í•´ë‹¹ ë‚ ì§œì˜ IDë¡œ ë³€ê²½
                if (dateToIdCache.has(dateKey)) {
                    currentId = dateToIdCache.get(dateKey);
                    currentRealDate = dateKey;
                    updateUrlInput();
                    hideCalendar();
                    await updateDateDisplay();
                    fetchData(); // ë°ì´í„° ìë™ ë¡œë“œ
                } else {
                    showError('í•´ë‹¹ ë‚ ì§œì˜ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜ ë‚ ì§œë¥¼ ì´ë™í•˜ì„¸ìš”.');
                }
            } else if (containerId === 'settingsCalendar') {
                // ì„¤ì • ìº˜ë¦°ë” ì„ íƒ: ê¸°ì¤€ ë‚ ì§œ ë³€ê²½
                baseDate = dateObj;
                document.getElementById('baseDateDisplay').textContent = formatDate(baseDate);
                hideSettingsCalendar();
            }
        }

        // ë‚ ì§œ í‘œì‹œ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
        async function updateDateDisplay() {
            if (dateIdCache.has(currentId)) {
                currentRealDate = dateIdCache.get(currentId);
                document.getElementById('currentDate').textContent = currentRealDate || '-';
            } else {
                // ìºì‹œì— ì—†ìœ¼ë©´ API í˜¸ì¶œì„ í†µí•´ ë‚ ì§œ í™•ì¸ ë¡œì§ ì‹¤í–‰ (ì›ë˜ ì½”ë“œì— ìˆì–´ì•¼ í•¨)
                const fetchedDate = await getDateFromTradingDayId(currentId);
                if (fetchedDate) {
                    currentRealDate = fetchedDate;
                    dateToIdCache.set(fetchedDate, currentId);
                    dateIdCache.set(currentId, fetchedDate);
                    saveWebData(); // ìºì‹œ ì €ì¥
                    document.getElementById('currentDate').textContent = fetchedDate;
                } else {
                    document.getElementById('currentDate').textContent = `${currentId} (ë‚ ì§œ ì •ë³´ ì—†ìŒ)`;
                    currentRealDate = '';
                }
            }
        }
        
        // URL ì…ë ¥ í•„ë“œ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
        function updateUrlInput() {
            const url = `${baseUrl}${currentId}${currentRealDate ? `/${currentRealDate}` : ''}`;
            document.getElementById('urlInput').value = url;
        }

        // API í†µì‹  ê´€ë ¨ ê°€ìƒ í•¨ìˆ˜ (ì‹¤ì œ ë™ì‘ì„ ìœ„í•´ì„œëŠ” ì„œë²„ í†µì‹  í•„ìš”)
        async function isTradingDay(date) {
            const dateKey = formatDate(date);
            if (holidaysCache[dateKey]) return false; // ê³µíœ´ì¼ì´ë©´ ê±°ë˜ì¼ ì•„ë‹˜
            const day = date.getDay();
            return day !== 0 && day !== 6; // ì£¼ë§ì´ ì•„ë‹ˆë©´ ê±°ë˜ì¼ë¡œ ê°€ì • (ê³µíœ´ì¼ì€ ìœ„ì—ì„œ ì²˜ë¦¬)
        }
        
        // ë‚ ì§œë¥¼ IDë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ (ê°€ì •)
        async function getTradingDayIdFromDate(date) {
            const dateKey = formatDate(date);
            if (dateToIdCache.has(dateKey)) return dateToIdCache.get(dateKey);
            
            // ì„ì‹œ: ID ê¸°ë°˜ìœ¼ë¡œ ë‚ ì§œë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ, ë©°ì¹  ì „ì¸ì§€ ì—­ì‚° (ì›ë˜ ë¡œì§ í•„ìš”)
            // ì—¬ê¸°ì„œëŠ” ì„ì‹œë¡œ í˜„ì¬ IDë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, ì˜¤ëŠ˜ ë‚ ì§œì˜ IDë¥¼ ì‚¬ìš©í•˜ë„ë¡ ê°€ì •
            
            // ì´ˆê¸° ë¡œë“œì‹œì—ëŠ” baseDateë¥¼ ê¸°ì¤€ìœ¼ë¡œ IDë¥¼ ê³„ì‚°í•´ì•¼ í•¨.
            if (dateKey === formatDate(baseDate)) return baseId; 
            
            // ì‹¤ì œ ë¡œì§ì—ì„œëŠ” IDì™€ ë‚ ì§œ ê°„ì˜ ìƒëŒ€ì ì¸ ì°¨ì´ë¥¼ ê³„ì‚°í•´ì•¼ í•¨.
            // í¸ì˜ìƒ, ì´ˆê¸° ë¡œë“œ ì‹œ ê¸°ë³¸ê°’ë§Œ ì‚¬ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤.
            return dateToIdCache.has(dateKey) ? dateToIdCache.get(dateKey) : currentId;
        }

        // IDë¥¼ ë‚ ì§œë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ (ê°€ì •)
        async function getDateFromTradingDayId(id) {
             // ìºì‹œ í™•ì¸
            if (dateIdCache.has(id)) return dateIdCache.get(id);
            
            // ì„ì‹œ: baseIdì™€ ë¹„êµí•˜ì—¬ ì°¨ì´ ê³„ì‚° (ì›ë˜ ë¡œì§ í•„ìš”)
            if (id === baseId) return formatDate(baseDate);

            return null; // ëª» ì°¾ìŒ
        }
        
        // ê³µíœ´ì¼ ë¡œë“œ í•¨ìˆ˜ (ê°€ì •)
        async function loadHolidaysForYear(year) {
            // ì‹¤ì œë¡œëŠ” ê³µíœ´ì¼ API í˜¸ì¶œ í•„ìš”. ì—¬ê¸°ì„œëŠ” ì„ì‹œ ê³µíœ´ì¼ ì„¤ì •
            const tempHolidays = {
                [`${year}-01-01`]: 'ì‹ ì •',
                [`${year}-12-25`]: 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
                // 2025ë…„ 10ì›” 3ì¼ì€ ê°œì²œì ˆ (ì˜ˆì‹œ)
                '2025-10-03': 'ê°œì²œì ˆ'
            };
            Object.assign(holidaysCache, tempHolidays);
        }
        
        function isHoliday(dateKey) {
            return !!holidaysCache[dateKey];
        }
        
        // fetchData, copyToExcel, toggleSettings, saveBaseSettings, updateUploadInfo, clearThemeData, showCacheInfo, importAllData, clearAllData, showSuccess, showError ë“± ë‚˜ë¨¸ì§€ í•¨ìˆ˜ëŠ” ë‚´ìš©ì´ ê¸¸ì–´ ìƒëµí•©ë‹ˆë‹¤. (ê¸°ëŠ¥ ìœ ì§€)

        // ----------------------------------------------------------------------
        // âš ï¸ í•„ìˆ˜: ì´ˆê¸°í™” í•¨ìˆ˜ í˜¸ì¶œ
        initialize();

    </script>
</body>
</html>